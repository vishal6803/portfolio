<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>Next-Gen Portfolio | Responsive</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap"
      rel="stylesheet"
    />

    <style>
      /* ---------------------------------
       * üé® Global Variables
       * --------------------------------- */
      :root {
        --bg: #050505;
        --fg: #e0e6ed;
        --accent: #4cc9f0;
        --accent-glow: rgba(76, 201, 240, 0.4);
        --sidebar-width: 220px;
        --mobile-nav-height: 70px;
        --glass: rgba(255, 255, 255, 0.03);
        --glass-border: rgba(255, 255, 255, 0.08);
        --easing: cubic-bezier(0.23, 1, 0.32, 1);
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: var(--bg);
        color: var(--fg);
        font-family: "Space Grotesk", monospace;
        overflow: hidden; /* Prevents body scroll, we scroll main instead */
      }

      /* ---------------------------------
       * üñºÔ∏è Background & Overlay
       * --------------------------------- */
      #glcanvas {
        position: fixed;
        inset: 0;
        z-index: 0;
        pointer-events: none;
      }

      #overlay {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 50; /* Above everything during transition */
        background: currentColor;
        opacity: 0;
      }

      /* ---------------------------------
       * üßä Fixed Sidebar (Desktop)
       * --------------------------------- */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        width: var(--sidebar-width);
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 25px;
        padding-left: 40px;
        z-index: 20;

        background: var(--glass);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-right: 1px solid var(--glass-border);
        transition: all 0.3s ease;
      }

      .menu-item {
        font-size: 1.1rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 2px;
        cursor: pointer;
        position: relative;
        color: rgba(255, 255, 255, 0.4);
        transition: color 0.3s;
        width: fit-content;
        padding: 10px 0;
      }

      .menu-item:hover,
      .menu-item.active {
        color: var(--fg);
        text-shadow: 0 0 10px var(--accent-glow);
      }

      /* Glitch Indicator */
      .menu-item::before {
        content: "";
        position: absolute;
        top: 50%;
        left: -20px;
        width: 0;
        height: 2px;
        background: var(--accent);
        box-shadow: 0 0 8px var(--accent);
        transition: width 0.4s var(--easing);
        transform: translateY(-50%);
      }
      .menu-item.active::before {
        width: 12px;
      }
      .menu-item:hover::before {
        width: 12px;
      }

      /* ---------------------------------
       * üìú Scrollable Main Content
       * --------------------------------- */
      main {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: var(--sidebar-width); /* Push content to right of sidebar */

        /* SCROLL LOGIC */
        overflow-y: auto;
        overflow-x: hidden;
        z-index: 5;
        padding: 0;
        scroll-behavior: smooth;
      }

      /* Custom Sci-Fi Scrollbar */
      main::-webkit-scrollbar {
        width: 8px;
      }
      main::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.3);
      }
      main::-webkit-scrollbar-thumb {
        background: var(--glass-border);
        border-radius: 4px;
      }
      main::-webkit-scrollbar-thumb:hover {
        background: var(--accent);
      }

      .content-container {
        min-height: 100vh; /* Ensure full height */
        padding: 80px 100px;
        max-width: 1000px;
        margin: 0 auto;
      }

      h1 {
        font-size: 4.5rem;
        margin: 0 0 30px 0;
        line-height: 0.95;
        background: linear-gradient(90deg, #fff, var(--accent));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      p {
        font-size: 1.25rem;
        line-height: 1.8;
        opacity: 0.85;
        margin-bottom: 30px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      /* ---------------------------------
       * üï∏Ô∏è Project Node Web
       * --------------------------------- */
      #node-container {
        position: relative;
        width: 100%;
        height: 500px; /* Fixed height for canvas */
        margin-top: 40px;
        margin-bottom: 60px; /* Space at bottom for scrolling */
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        overflow: hidden;
        backdrop-filter: blur(5px);
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      }

      #node-canvas {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }

      .node {
        position: absolute;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--accent);
        box-shadow: 0 0 15px var(--accent-glow),
          inset 0 0 10px var(--accent-glow);
        cursor: pointer;
        z-index: 2;
        /* Prevent selection during drag */
        user-select: none;
      }

      .node-icon {
        font-size: 18px;
        pointer-events: none;
      }

      .node-label {
        position: absolute;
        top: -35px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--accent);
        color: #000;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 700;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: 0.2s;
      }
      .node:hover .node-label {
        opacity: 1;
        top: -45px;
      }

      /* ---------------------------------
       * üì± RESPONSIVE (Mobile)
       * --------------------------------- */
      @media (max-width: 900px) {
        /* Convert Sidebar to Bottom Navigation */
        :root {
          --sidebar-width: 0px;
        }

        .sidebar {
          top: auto;
          bottom: 0;
          left: 0;
          right: 0;
          width: 100%;
          height: var(--mobile-nav-height);
          flex-direction: row;
          align-items: center;
          justify-content: space-evenly;
          padding: 0;
          border-right: none;
          border-top: 1px solid var(--glass-border);
          background: rgba(5, 5, 5, 0.95); /* Darker bg for contrast */
        }

        .menu-item {
          font-size: 0.85rem;
          letter-spacing: 1px;
          padding: 10px;
        }

        /* Adjust indicator for horizontal layout */
        .menu-item::before {
          top: auto;
          bottom: 0;
          left: 50%;
          width: 0;
          height: 3px;
          transform: translateX(-50%);
        }
        .menu-item.active::before,
        .menu-item:hover::before {
          width: 20px;
        }

        /* Content adjustments */
        main {
          left: 0;
          bottom: var(--mobile-nav-height); /* Stop scrolling before nav bar */
        }

        .content-container {
          padding: 40px 25px;
          /* Add extra padding at bottom so content isn't hidden behind nav */
          padding-bottom: 80px;
        }

        h1 {
          font-size: 2.8rem;
        }
        p {
          font-size: 1.1rem;
        }

        #node-container {
          height: 350px;
        }
      }
    </style>
  </head>

  <body>
    <canvas id="glcanvas"></canvas>

    <div id="overlay"></div>

    <nav class="sidebar">
      <div class="menu-item active" data-page="home">Home</div>
      <div class="menu-item" data-page="projects">Projects</div>
      <div class="menu-item" data-page="about">About</div>
      <div class="menu-item" data-page="contact">Contact</div>
    </nav>

    <main id="main-scroller">
      <div id="content" class="content-container"></div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/three@0.146.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.3/dist/gsap.min.js"></script>

    <script>
      /* --------------------------------------------------------------------------
       * ‚öôÔ∏è CONFIGURATION
       * -------------------------------------------------------------------------- */
      const THEMES = {
        home: {
          bg: "#050505",
          fg: "#e0e6ed",
          accent: "#4cc9f0",
          // UPDATED: Darker, semi-transparent teal-blue for smooth transition
          overlay: "#1a4a58b3",
          threeColor: 0x4cc9f0,
        },
        projects: {
          bg: "#0d0612",
          fg: "#fcefed",
          accent: "#f72585",
          // UPDATED: Darker, semi-transparent magenta/pink
          overlay: "#500a2cb3",
          threeColor: 0xf72585,
        },
        about: {
          bg: "#020f12",
          fg: "#d4fff7",
          accent: "#00f5d4",
          // UPDATED: Darker, semi-transparent cyan/mint
          overlay: "#014c40b3",
          threeColor: 0x00f5d4,
        },
        contact: {
          bg: "#0b0b1e",
          fg: "#dedeff",
          accent: "#7209b7",
          // UPDATED: Darker, semi-transparent purple
          overlay: "#30044eb3",
          threeColor: 0x7209b7,
        },
      };

      const PAGES = {
        home: `
          <div>
  <h1 data-scramble="true">HELLO_WORLD</h1>

  <p>
    I build modern web interfaces with a focus on motion, responsiveness, and clean UI engineering.
    This space blends Three.js visuals with GSAP-driven transitions for an immersive feel.
  </p>

  <p>
    // STATUS: ONLINE<br>
    // ROLE: FRONTEND_DEVELOPER<br>
    // EXPERIENCE: <strong>1.3 YEARS</strong><br>
    // STACK: REACT ‚Ä¢ JS/TS ‚Ä¢ UI SYSTEMS
  </p>
  </div>
        `,
        projects: `
          <div style="width: 100%;">
            <h1 data-scramble="true">SYSTEM_NODES</h1>
            <p>Drag nodes to interact with the physics engine. Connections represent tech-stack dependencies.</p>
            <div id="node-container">
              <canvas id="node-canvas"></canvas>
            </div>
            <p>Projects include:</p>
            <ul style="line-height:2; font-size:1.1rem; list-style:none; padding:0;">
              <li style="border-bottom:1px solid rgba(255,255,255,0.1); padding:10px 0;">üöÄ <strong>Portfolio V1</strong> - React & Framer Motion</li>
              <li style="border-bottom:1px solid rgba(255,255,255,0.1); padding:10px 0;">üéÆ <strong>Game Engine</strong> - C++ & OpenGL</li>
              <li style="border-bottom:1px solid rgba(255,255,255,0.1); padding:10px 0;">üß† <strong>AI Chatbot</strong> - Python & TensorFlow</li>
            </ul>
          </div>
        `,
        about: `
          <div>
  <h1 data-scramble="true">
    Vishal ‚Äî <span class="scramble">Frontend Developer</span>
  </h1>

  <p>
    Frontend Developer with 1.3 years of experience building clean, reliable,
    and scalable web applications. I specialize in React and TypeScript,
    focusing on fast performance and polished UI development.
  </p>

  <h3 style="color:var(--accent); margin-top:40px;">Skills</h3>
  <p>
    React, JavaScript (ES6+), TypeScript, MUI, Tailwind, Redux Toolkit,
    RTK Query, Next.js (CSR), Node.js (basic), Express (basic), SQL (basic),
    UI Development, API Integration.
  </p>

  <h3 style="color:var(--accent); margin-top:40px;">Experience</h3>
  <p>
    1.3 years of experience delivering production-grade frontend features.
    Worked on ERP dashboards, weather apps, news apps, quiz platforms, and
    a Splitwise-style expense app. Experienced with React, MUI, RTK Query,
    component architecture, and building UI for real-world products as a
    Frontend Developer Trainee.
  </p>

  <h3 style="color:var(--accent); margin-top:40px;">Background</h3>
  <p>
    I focus on writing clean reusable components, improving UX flow, and
    creating scalable frontend structures suitable for long-term product growth.
  </p>
</div>

        `,
        contact: `
          <div>
            <h1 data-scramble="true">SIGNAL_UPLINK</h1>
            <p>Transmission channels are open. Send encrypted data packets or simple text messages.</p>
            <p style="color: var(--accent); font-weight: bold; font-size: 2rem; margin-top:20px;">email@future.net</p>
            <div style="margin-top: 50px; padding: 30px; border: 1px solid var(--glass-border); background: var(--glass); border-radius: 12px;">
                <p style="margin:0 0 10px 0; font-size:0.9rem; color:var(--accent);">SEND MESSAGE</p>
                <input type="text" placeholder="Subject Class..." style="width:100%; background:transparent; border:none; border-bottom:1px solid #555; padding:10px 0; color:#fff; font-family:inherit; font-size:1.2rem; outline:none;">
            </div>
          </div>
        `,
      };

      /* --------------------------------------------------------------------------
       * üî† UTILS
       * -------------------------------------------------------------------------- */
      function scrambleText(element) {
        const originalText = element.innerText;
        const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890@#$%&";
        let iterations = 0;
        if (element.dataset.interval) clearInterval(element.dataset.interval);

        const interval = setInterval(() => {
          element.innerText = originalText
            .split("")
            .map((letter, index) => {
              if (index < iterations) return originalText[index];
              return chars[Math.floor(Math.random() * chars.length)];
            })
            .join("");
          if (iterations >= originalText.length) clearInterval(interval);
          iterations += 1 / 2;
        }, 30);
        element.dataset.interval = interval;
      }

      /* --------------------------------------------------------------------------
       * üåü 3D BACKGROUND
       * -------------------------------------------------------------------------- */
      class StarField {
        constructor() {
          this.canvas = document.getElementById("glcanvas");
          this.renderer = new THREE.WebGLRenderer({
            canvas: this.canvas,
            alpha: true,
            antialias: true,
          });
          this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Optimize for mobile
          this.scene = new THREE.Scene();
          this.camera = new THREE.PerspectiveCamera(
            75,
            window.innerWidth / window.innerHeight,
            0.1,
            1000
          );
          this.camera.position.z = 400;
          this.mouse = { x: 0, y: 0 };
          this.targetRotation = { x: 0, y: 0 };
          this.initParticles();
          this.addListeners();
          this.animate();
        }

        initParticles() {
          const geometry = new THREE.BufferGeometry();
          const count = 800; // Reduced count slightly for mobile performance
          const posArray = new Float32Array(count * 3);
          for (let i = 0; i < count * 3; i++)
            posArray[i] = (Math.random() - 0.5) * 1500;
          geometry.setAttribute(
            "position",
            new THREE.BufferAttribute(posArray, 3)
          );
          const sprite = new THREE.TextureLoader().load(
            "https://threejs.org/examples/textures/sprites/disc.png"
          );
          this.material = new THREE.PointsMaterial({
            size: 4,
            map: sprite,
            transparent: true,
            color: THEMES.home.threeColor,
            blending: THREE.AdditiveBlending,
            depthWrite: false,
            opacity: 0.8,
          });
          this.particles = new THREE.Points(geometry, this.material);
          this.scene.add(this.particles);
        }

        changeColor(hexColor) {
          const target = new THREE.Color(hexColor);
          gsap.to(this.material.color, {
            r: target.r,
            g: target.g,
            b: target.b,
            duration: 1.5,
          });
        }

        addListeners() {
          window.addEventListener("resize", () => {
            this.camera.aspect = window.innerWidth / window.innerHeight;
            this.camera.updateProjectionMatrix();
            this.renderer.setSize(window.innerWidth, window.innerHeight);
          });
          window.addEventListener("mousemove", (e) => {
            this.mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            this.mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
          });
        }

        animate() {
          requestAnimationFrame(this.animate.bind(this));
          this.targetRotation.x +=
            (this.mouse.y * 0.5 - this.targetRotation.x) * 0.05;
          this.targetRotation.y +=
            (this.mouse.x * 0.5 - this.targetRotation.y) * 0.05;
          this.particles.rotation.x += 0.0005;
          this.particles.rotation.y += 0.0005;
          this.scene.rotation.x = this.targetRotation.x * 0.2;
          this.scene.rotation.y = this.targetRotation.y * 0.2;
          this.renderer.render(this.scene, this.camera);
        }
      }

      /* --------------------------------------------------------------------------
       * üï∏Ô∏è NODE SYSTEM
       * -------------------------------------------------------------------------- */
      const PROJECTS_DATA = [
        { name: "Three", icon: "üíé" },
        { name: "React", icon: "‚öõÔ∏è" },
        { name: "Node", icon: "üü¢" },
        { name: "WebGL", icon: "üï∏Ô∏è" },
        { name: "AI", icon: "üß†" },
        { name: "UX", icon: "üé®" },
      ];
      let nodeSimulation = null;

      function initProjectsWeb() {
        const container = document.getElementById("node-container");
        const canvas = document.getElementById("node-canvas");
        if (!container || !canvas) return;

        const ctx = canvas.getContext("2d");

        // Wait for layout to settle before sizing
        setTimeout(() => {
          canvas.width = container.clientWidth;
          canvas.height = container.clientHeight;
        }, 50);

        // Update on resize
        const resizeObserver = new ResizeObserver(() => {
          canvas.width = container.clientWidth;
          canvas.height = container.clientHeight;
        });
        resizeObserver.observe(container);

        const nodes = PROJECTS_DATA.map(() => ({
          x: Math.random() * (canvas.width || 300),
          y: Math.random() * (canvas.height || 300),
          vx: (Math.random() - 0.5) * 1.5,
          vy: (Math.random() - 0.5) * 1.5,
        }));

        // Create DOM Elements
        container.innerHTML = ""; // Clear prev
        container.appendChild(canvas);

        const domNodes = PROJECTS_DATA.map((p, i) => {
          const el = document.createElement("div");
          el.className = "node";
          el.innerHTML = `<span class="node-icon">${p.icon}</span><div class="node-label">${p.name}</div>`;
          container.appendChild(el);
          gsap.from(el, {
            scale: 0,
            duration: 0.5,
            delay: i * 0.1,
            ease: "back.out(1.7)",
          });
          return el;
        });

        function update() {
          const width = canvas.width;
          const height = canvas.height;
          ctx.clearRect(0, 0, width, height);
          ctx.beginPath();
          ctx.strokeStyle = getComputedStyle(
            document.documentElement
          ).getPropertyValue("--accent-glow");

          nodes.forEach((n, i) => {
            n.x += n.vx;
            n.y += n.vy;
            if (n.x <= 20 || n.x >= width - 20) n.vx *= -1;
            if (n.y <= 20 || n.y >= height - 20) n.vy *= -1;

            // Sync DOM
            domNodes[i].style.transform = `translate(${n.x - 22}px, ${
              n.y - 22
            }px)`;

            // Draw Lines
            for (let j = i + 1; j < nodes.length; j++) {
              const dx = n.x - nodes[j].x;
              const dy = n.y - nodes[j].y;
              const dist = Math.sqrt(dx * dx + dy * dy);
              if (dist < 150) {
                ctx.moveTo(n.x, n.y);
                ctx.lineTo(nodes[j].x, nodes[j].y);
              }
            }
          });
          ctx.stroke();
          nodeSimulation = requestAnimationFrame(update);
        }
        update();
      }

      /* --------------------------------------------------------------------------
       * üß≠ NAVIGATION
       * -------------------------------------------------------------------------- */
      const menuItems = document.querySelectorAll(".menu-item");
      const contentContainer = document.getElementById("content");
      const scroller = document.getElementById("main-scroller");
      const overlay = document.getElementById("overlay");
      const bg3D = new StarField();

      function loadPage(pageKey) {
        const theme = THEMES[pageKey];

        // CSS Vars
        gsap.to(document.documentElement, {
          "--bg": theme.bg,
          "--fg": theme.fg,
          "--accent": theme.accent,
          "--accent-glow": theme.accent + "66",
          duration: 1,
        });

        bg3D.changeColor(theme.threeColor);
        overlay.style.backgroundColor = theme.overlay;

        const tl = gsap.timeline();
        tl.to(overlay, {
          opacity: 1,
          duration: 0.4,
          ease: "power2.inOut",
          onComplete: () => {
            contentContainer.innerHTML = PAGES[pageKey];

            // IMPORTANT: Reset Scroll Position
            scroller.scrollTop = 0;

            if (nodeSimulation) cancelAnimationFrame(nodeSimulation);
            if (pageKey === "projects") initProjectsWeb();

            const title = contentContainer.querySelector(
              'h1[data-scramble="true"]'
            );
            if (title) scrambleText(title);
          },
        });

        tl.to(overlay, { opacity: 0, duration: 0.6, ease: "power2.inOut" });
        tl.fromTo(
          contentContainer.children,
          { y: 30, opacity: 0 },
          { y: 0, opacity: 1, stagger: 0.1, duration: 0.5 },
          "-=0.4"
        );
      }

      menuItems.forEach((item) => {
        item.addEventListener("click", () => {
          if (item.classList.contains("active")) return;
          menuItems.forEach((i) => i.classList.remove("active"));
          item.classList.add("active");
          loadPage(item.dataset.page);
        });
      });

      loadPage("home");
    </script>
  </body>
</html>
