<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <title>Next-Gen Portfolio | Interactive</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/devicon.min.css"
    />

    <style>
      /* ---------------------------------
       * üé® Global Variables
       * --------------------------------- */
      :root {
        --bg: #050505;
        --fg: #e0e6ed;
        --accent: #4cc9f0;
        --accent-glow: rgba(76, 201, 240, 0.4);
        --sidebar-width: 220px;
        --mobile-nav-height: 70px;
        --glass: rgba(255, 255, 255, 0.03);
        --glass-border: rgba(255, 255, 255, 0.08);
        --easing: cubic-bezier(0.23, 1, 0.32, 1);
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: var(--bg);
        color: var(--fg);
        font-family: "Space Grotesk", monospace;
        overflow: hidden;
      }

      /* ---------------------------------
       * üñºÔ∏è Background & Overlay
       * --------------------------------- */
      #glcanvas {
        position: fixed;
        inset: 0;
        z-index: 0;
        pointer-events: none;
      }

      #overlay {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 50;
        background: currentColor;
        opacity: 0;
      }

      /* ---------------------------------
       * üßä Sidebar
       * --------------------------------- */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        width: var(--sidebar-width);
        display: flex;
        flex-direction: column;
        justify-content: center;
        gap: 25px;
        padding-left: 40px;
        z-index: 20;
        background: var(--glass);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-right: 1px solid var(--glass-border);
        transition: all 0.3s ease;
      }

      .menu-item {
        font-size: 1.1rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 2px;
        cursor: pointer;
        position: relative;
        color: rgba(255, 255, 255, 0.4);
        transition: color 0.3s;
        width: fit-content;
        padding: 10px 0;
      }

      .menu-item:hover,
      .menu-item.active {
        color: var(--fg);
        text-shadow: 0 0 10px var(--accent-glow);
      }

      .menu-item::before {
        content: "";
        position: absolute;
        top: 50%;
        left: -20px;
        width: 0;
        height: 2px;
        background: var(--accent);
        box-shadow: 0 0 8px var(--accent);
        transition: width 0.4s var(--easing);
        transform: translateY(-50%);
      }
      .menu-item.active::before,
      .menu-item:hover::before {
        width: 12px;
      }

      /* ---------------------------------
       * üìú Content
       * --------------------------------- */
      main {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: var(--sidebar-width);
        overflow-y: auto;
        overflow-x: hidden;
        z-index: 5;
        padding: 0;
        scroll-behavior: smooth;
      }

      main::-webkit-scrollbar {
        width: 8px;
      }
      main::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.3);
      }
      main::-webkit-scrollbar-thumb {
        background: var(--glass-border);
        border-radius: 4px;
      }
      main::-webkit-scrollbar-thumb:hover {
        background: var(--accent);
      }

      .content-container {
        min-height: 100vh;
        padding: 80px 100px;
        max-width: 1000px;
        margin: 0 auto;
      }

      h1 {
        font-size: 4.5rem;
        margin: 0 0 30px 0;
        line-height: 0.95;
        background: linear-gradient(90deg, #fff, var(--accent));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      p {
        font-size: 1.25rem;
        line-height: 1.8;
        opacity: 0.85;
        margin-bottom: 30px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      /* ---------------------------------
       * üï∏Ô∏è Project Node Web
       * --------------------------------- */
      #node-container {
        position: relative;
        width: 100%;
        height: 500px;
        margin-top: 40px;
        margin-bottom: 60px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid var(--glass-border);
        border-radius: 16px;
        overflow: hidden;
        backdrop-filter: blur(5px);
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      }

      #node-canvas {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }

      .node {
        position: absolute;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--accent);
        box-shadow: 0 0 15px var(--accent-glow),
          inset 0 0 10px var(--accent-glow);
        cursor: pointer;
        z-index: 2;
        user-select: none;
      }

      .node-icon {
        font-size: 18px;
        pointer-events: none;
      }

      .node-label {
        position: absolute;
        top: -35px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--accent);
        color: #000;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 700;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        transition: 0.2s;
      }
      .node:hover .node-label {
        opacity: 1;
        top: -45px;
      }
      /* --- Data Log Styling --- */
.project-log-container {
    margin-top: 40px;
    border: 1px solid var(--glass-border);
    border-radius: 4px;
    overflow: hidden;
}

.log-header, .log-entry {
    display: grid;
    grid-template-columns: 50px 2fr 1.5fr 1fr; /* Defines column widths */
    padding: 15px 20px;
    align-items: center;
    font-size: 0.95rem;
    transition: background-color 0.3s, color 0.3s;
}

.log-header {
    background: rgba(0, 0, 0, 0.5);
    color: var(--accent);
    font-weight: 700;
    letter-spacing: 1px;
    border-bottom: 1px solid var(--glass-border);
    text-transform: uppercase;
}

.log-entry {
    color: var(--fg);
    text-decoration: none;
    cursor: pointer;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.log-entry:hover {
    background: rgba(0, 212, 255, 0.1); /* Slight accent background */
    color: #fff;
    box-shadow: inset 3px 0 0 var(--accent); /* Left border glow */
}

.log-status {
    font-weight: 700;
    text-align: right;
}

.log-status.online {
    color: var(--accent); /* Cyan */
    text-shadow: 0 0 5px rgba(0, 212, 255, 0.6);
}

.log-status.offline {
    color: #ff5500; /* Orange/Red for limited access */
}

      /* ---------------------------------
       * üì± RESPONSIVE
       * --------------------------------- */
      @media (max-width: 900px) {
        :root {
          --sidebar-width: 0px;
        }
        .sidebar {
          top: auto;
          bottom: 0;
          left: 0;
          right: 0;
          width: 100%;
          height: var(--mobile-nav-height);
          flex-direction: row;
          align-items: center;
          justify-content: space-evenly;
          padding: 0;
          border-right: none;
          border-top: 1px solid var(--glass-border);
          background: rgba(5, 5, 5, 0.95);
        }
        .menu-item {
          font-size: 0.85rem;
          letter-spacing: 1px;
          padding: 10px;
        }
        .menu-item::before {
          top: auto;
          bottom: 0;
          left: 50%;
          width: 0;
          height: 3px;
          transform: translateX(-50%);
        }
        .menu-item.active::before,
        .menu-item:hover::before {
          width: 20px;
        }
        main {
          left: 0;
          bottom: var(--mobile-nav-height);
        }
        .content-container {
          padding: 40px 25px 80px 25px;
        }
        h1 {
          font-size: 2.8rem;
        }
        p {
          font-size: 1.1rem;
        }
        #node-container {
          height: 350px;
        }
      }
    </style>
  </head>

  <body>
    <canvas id="glcanvas"></canvas>
    <div id="overlay"></div>

    <nav class="sidebar">
      <div class="menu-item active" data-page="home">Home</div>
      <div class="menu-item" data-page="projects">Projects</div>
      <div class="menu-item" data-page="about">About</div>
      <div class="menu-item" data-page="contact">Contact</div>
    </nav>

    <main id="main-scroller">
      <div id="content" class="content-container"></div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/three@0.146.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.11.3/dist/gsap.min.js"></script>

    <script>
      /* --------------------------------------------------------------------------
       * ‚öôÔ∏è CONFIG & DATA
       * -------------------------------------------------------------------------- */
      const THEMES = {
        home: {
          bg: "#050505",
          fg: "#e0e6ed",
          accent: "#4cc9f0",
          overlay: "#1a4a58b3",
          threeColor: 0x4cc9f0,
        },
        projects: {
          bg: "#0d0612",
          fg: "#fcefed",
          accent: "#f72585",
          overlay: "#500a2cb3",
          threeColor: 0xf72585,
        },
        about: {
          bg: "#020f12",
          fg: "#d4fff7",
          accent: "#00f5d4",
          overlay: "#014c40b3",
          threeColor: 0x00f5d4,
        },
        contact: {
          bg: "#0b0b1e",
          fg: "#dedeff",
          accent: "#7209b7",
          overlay: "#30044eb3",
          threeColor: 0x7209b7,
        },
      };

      const PAGES = {
        home: `
          <div>
            <h1 data-scramble="true">HELLO_WORLD</h1>
            <p>I build modern web interfaces with a focus on motion, responsiveness, and clean UI engineering.</p>
            <p>// STATUS: ONLINE<br>// ROLE: FRONTEND_DEVELOPER<br>// EXPERIENCE: <strong>1.3 YEARS</strong><br>// STACK: REACT ‚Ä¢ JS/TS ‚Ä¢ UI SYSTEMS</p>
            <p style="font-size:0.9rem; opacity:0.6; margin-top:50px;">* Scroll to engage warp drive.</p>
          </div>
        `,
        projects: `
          <div style="width: 100%;">
            <h1 data-scramble="true">SYSTEM_NODES</h1>
            <h3 style="color:var(--accent); margin-top:40px;">Skills</h3>
            <div id="node-container"><canvas id="node-canvas"></canvas></div>
           <div class="project-log-container">
    <div class="log-header">
        <span class="log-index">#ID</span>
        <span class="log-title">System Name</span>
        <span class="log-stack">Core Stack</span>
        <span class="log-status">Link / Status</span>
    </div>
    <a href="[LINK_TO_PROJECT_1]" target="_blank" class="log-entry">
        <span class="log-index">001</span>
        <span class="log-title">üöÄ Portfolio V1</span>
        <span class="log-stack">React & Framer Motion</span>
        <span class="log-status online">ACCESS GRANTED</span>
    </a>
    <a href="[LINK_TO_PROJECT_2]" target="_blank" class="log-entry">
        <span class="log-index">002</span>
        <span class="log-title">üéÆ Game Engine</span>
        <span class="log-stack">C++ & OpenGL</span>
        <span class="log-status offline">ACCESS LIMITED</span>
    </a>
    <a href="[LINK_TO_PROJECT_3]" target="_blank" class="log-entry">
        <span class="log-index">003</span>
        <span class="log-title">üß† AI Chatbot</span>
        <span class="log-stack">Python & TensorFlow</span>
        <span class="log-status online">ACCESS GRANTED</span>
    </a>
</div>
          </div>
        `,
        about: `
          <div>
            <h1 data-scramble="true">Vishal ‚Äî <span class="scramble">Dev</span></h1>
            <p>Frontend Developer with 1.3 years of experience building clean, reliable, and scalable web applications. I specialize in React and TypeScript.</p>
            <h3 style="color:var(--accent); margin-top:40px;">Skills</h3>
            <p>React, JavaScript (ES6+), TypeScript, MUI, Tailwind, Redux Toolkit, RTK Query, Next.js (CSR), Node.js (basic).</p>
            <h3 style="color:var(--accent); margin-top:40px;">Experience</h3>
            <p>1.3 years of experience delivering production-grade frontend features. Worked on ERP dashboards, weather apps, news apps, and expense trackers.</p>
          </div>
        `,
        contact: `
          <div>
            <h1 data-scramble="true">SIGNAL_UPLINK</h1>
            <p>Transmission channels are open.</p>
            <p style="color: var(--accent); font-weight: bold; font-size: 2rem; margin-top:20px;">email@future.net</p>
            <div style="margin-top: 50px; padding: 30px; border: 1px solid var(--glass-border); background: var(--glass); border-radius: 12px;">
                <p style="margin:0 0 10px 0; font-size:0.9rem; color:var(--accent);">SEND MESSAGE</p>
                <input type="text" placeholder="Subject Class..." style="width:100%; background:transparent; border:none; border-bottom:1px solid #555; padding:10px 0; color:#fff; font-family:inherit; font-size:1.2rem; outline:none;">
            </div>
          </div>
        `,
      };

      /* --------------------------------------------------------------------------
       * üî† UTILS
       * -------------------------------------------------------------------------- */
      function scrambleText(element) {
        const originalText = element.innerText;
        const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890@#$%&";
        let iterations = 0;
        if (element.dataset.interval) clearInterval(element.dataset.interval);

        const interval = setInterval(() => {
          element.innerText = originalText
            .split("")
            .map((letter, index) => {
              if (index < iterations) return originalText[index];
              return chars[Math.floor(Math.random() * chars.length)];
            })
            .join("");
          if (iterations >= originalText.length) clearInterval(interval);
          iterations += 1 / 2;
        }, 30);
        element.dataset.interval = interval;
      }

      /* --------------------------------------------------------------------------
       * üåü 3D SCENE MANAGER
       * -------------------------------------------------------------------------- */
      class SceneManager {
        constructor() {
          this.canvas = document.getElementById("glcanvas");
          this.renderer = new THREE.WebGLRenderer({
            canvas: this.canvas,
            alpha: true,
            antialias: true,
          });
          this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
          this.scene = new THREE.Scene();
          this.camera = new THREE.PerspectiveCamera(
            75,
            window.innerWidth / window.innerHeight,
            0.1,
            2000
          );
          this.camera.position.z = 400;

          this.mouse = { x: 0, y: 0 };
          this.scrollSpeed = 0;

          this.objects = []; // Floating shapes

          this.initStars();
          this.initDataRain();
          this.initFloatingShapes();
          this.addListeners();
          this.animate();
        }

        /* 1. Background Stars */
        initStars() {
          const geometry = new THREE.BufferGeometry();
          const count = 1000;
          const posArray = new Float32Array(count * 3);
          for (let i = 0; i < count * 3; i++)
            posArray[i] = (Math.random() - 0.5) * 1500;
          geometry.setAttribute(
            "position",
            new THREE.BufferAttribute(posArray, 3)
          );

          const sprite = new THREE.TextureLoader().load(
            "https://threejs.org/examples/textures/sprites/disc.png"
          );
          this.starMaterial = new THREE.PointsMaterial({
            size: 3,
            map: sprite,
            transparent: true,
            color: THEMES.home.threeColor,
            blending: THREE.AdditiveBlending,
            opacity: 0.8,
            depthWrite: false,
          });
          this.starParticles = new THREE.Points(geometry, this.starMaterial);
          this.scene.add(this.starParticles);
        }

        /* 2. Falling Data / Commits */
        initDataRain() {
          // Creating vertical streaks of data
          const geometry = new THREE.BufferGeometry();
          const count = 300;
          const posArray = new Float32Array(count * 3);
          const speeds = [];

          for (let i = 0; i < count; i++) {
            posArray[i * 3] = (Math.random() - 0.5) * 1200; // x
            posArray[i * 3 + 1] = (Math.random() - 0.5) * 1000; // y
            posArray[i * 3 + 2] = (Math.random() - 0.5) * 600; // z
            speeds.push(Math.random() * 2 + 0.5);
          }

          geometry.setAttribute(
            "position",
            new THREE.BufferAttribute(posArray, 3)
          );
          this.rainGeometry = geometry;
          this.rainSpeeds = speeds;

          this.rainMaterial = new THREE.PointsMaterial({
            color: THEMES.home.threeColor,
            size: 4,
            transparent: true,
            opacity: 0.6,
            blending: THREE.AdditiveBlending,
            depthWrite: false,
          });

          this.rainSystem = new THREE.Points(geometry, this.rainMaterial);
          this.scene.add(this.rainSystem);
        }

        /* 3. Floating Tech Artifacts */
        initFloatingShapes() {
          const geometries = [
            new THREE.IcosahedronGeometry(30, 0),
            new THREE.TorusGeometry(20, 5, 16, 100),
            new THREE.OctahedronGeometry(25),
          ];

          for (let i = 0; i < 4; i++) {
            const geom =
              geometries[Math.floor(Math.random() * geometries.length)];
            const mat = new THREE.MeshBasicMaterial({
              color: THEMES.home.threeColor,
              wireframe: true,
              transparent: true,
              opacity: 0.15,
            });
            const mesh = new THREE.Mesh(geom, mat);

            // Random Position
            mesh.position.set(
              (Math.random() - 0.5) * 800,
              (Math.random() - 0.5) * 600,
              (Math.random() - 0.5) * 400 - 100
            );

            // Random Rotation speed
            mesh.userData = {
              rotX: (Math.random() - 0.5) * 0.01,
              rotY: (Math.random() - 0.5) * 0.01,
            };

            this.scene.add(mesh);
            this.objects.push(mesh);
          }
        }

        changeColor(hexColor) {
          const target = new THREE.Color(hexColor);

          // Animate Stars
          gsap.to(this.starMaterial.color, {
            r: target.r,
            g: target.g,
            b: target.b,
            duration: 1.5,
          });

          // Animate Rain
          gsap.to(this.rainMaterial.color, {
            r: target.r,
            g: target.g,
            b: target.b,
            duration: 1.5,
          });

          // Animate Shapes
          this.objects.forEach((obj) => {
            gsap.to(obj.material.color, {
              r: target.r,
              g: target.g,
              b: target.b,
              duration: 1.5,
            });
          });
        }

        addListeners() {
          window.addEventListener("resize", () => {
            this.camera.aspect = window.innerWidth / window.innerHeight;
            this.camera.updateProjectionMatrix();
            this.renderer.setSize(window.innerWidth, window.innerHeight);
          });

          window.addEventListener("mousemove", (e) => {
            this.mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            this.mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
          });

          // Scroll Speed Boost
          const scroller = document.getElementById("main-scroller");
          let scrollTimeout;
          scroller.addEventListener("scroll", () => {
            this.scrollSpeed = 5; // Warp speed!
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
              gsap.to(this, { scrollSpeed: 0, duration: 0.5 });
            }, 100);
          });
        }

        animate() {
          requestAnimationFrame(this.animate.bind(this));

          // 1. Rotate entire Star System based on mouse
          this.starParticles.rotation.x += 0.0005;
          this.starParticles.rotation.y += 0.0005;

          // Mouse Parallax
          const targetRotX = this.mouse.y * 0.2;
          const targetRotY = this.mouse.x * 0.2;
          this.scene.rotation.x += (targetRotX - this.scene.rotation.x) * 0.05;
          this.scene.rotation.y += (targetRotY - this.scene.rotation.y) * 0.05;

          // 2. Animate Data Rain (Falling)
          const positions = this.rainGeometry.attributes.position.array;
          for (let i = 0; i < 300; i++) {
            // Y position -= speed + scrollBoost
            positions[i * 3 + 1] -= this.rainSpeeds[i] + this.scrollSpeed * 2;

            // Reset to top if out of bounds
            if (positions[i * 3 + 1] < -500) {
              positions[i * 3 + 1] = 500;
              positions[i * 3] = (Math.random() - 0.5) * 1200; // Randomize X again
            }
          }
          this.rainGeometry.attributes.position.needsUpdate = true;

          // 3. Animate Floating Objects
          this.objects.forEach((obj) => {
            obj.rotation.x += obj.userData.rotX + this.scrollSpeed * 0.01;
            obj.rotation.y += obj.userData.rotY;
            // Gentle float
            obj.position.y +=
              Math.sin(Date.now() * 0.001 + obj.position.x) * 0.1;
          });

          // Move camera slightly on Z based on scroll speed for "Warp" feel
          this.camera.position.z = 400 - this.scrollSpeed * 10;

          this.renderer.render(this.scene, this.camera);
        }
      }

      /* --------------------------------------------------------------------------
       * üï∏Ô∏è NODE SYSTEM (2D)
       * -------------------------------------------------------------------------- */
      const PROJECTS_DATA = [
        {
          name: "JavaScript",
          icon: '<i class="devicon-javascript-plain colored"></i>',
        },
        {
          name: "TypeScript",
          icon: '<i class="devicon-typescript-plain colored"></i>',
        },
        { name: "HTML", icon: '<i class="devicon-html5-plain colored"></i>' },
        { name: "CSS", icon: '<i class="devicon-css3-plain colored"></i>' },
        {
          name: "Redux Toolkit",
          icon: '<i class="devicon-redux-original colored"></i>',
        },
        {
          name: "Next.js",
          icon: '<img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/nextjs/nextjs-original.svg" width="24"/>',
        },
        {
          name: "Node.js",
          icon: '<i class="devicon-nodejs-plain colored"></i>',
        },
        { name: "Express", icon: '<i class="devicon-express-original"></i>' },
        // { name: "REST API", icon: '<i class="devicon-api-original"></i>' }, // no official API icon
        {
          name: "REST API",
          icon: '<svg width="22" height="22" viewBox="0 0 24 24"><path fill="currentColor" d="M5 12h14M12 5v14M4 4h4v4H4zm12 0h4v4h-4zM4 16h4v4H4zm12 0h4v4h-4z"/></svg>',
        },

        {
          name: "Tailwind",
          icon: '<i class="devicon-tailwindcss-plain colored"></i>',
        },
        {
          name: "Material UI",
          icon: '<i class="devicon-materialui-plain colored"></i>',
        },
        {
          name: "Bootstrap",
          icon: '<i class="devicon-bootstrap-plain colored"></i>',
        },
      ];
      let nodeSimulation = null;

      function initProjectsWeb() {
        const container = document.getElementById("node-container");
        const canvas = document.getElementById("node-canvas");
        if (!container || !canvas) return;

        const ctx = canvas.getContext("2d");

        setTimeout(() => {
          canvas.width = container.clientWidth;
          canvas.height = container.clientHeight;
        }, 50);

        const resizeObserver = new ResizeObserver(() => {
          canvas.width = container.clientWidth;
          canvas.height = container.clientHeight;
        });
        resizeObserver.observe(container);

        const nodes = PROJECTS_DATA.map(() => ({
          x: Math.random() * (canvas.width || 300),
          y: Math.random() * (canvas.height || 300),
          vx: (Math.random() - 0.5) * 1.5,
          vy: (Math.random() - 0.5) * 1.5,
        }));

        container.innerHTML = "";
        container.appendChild(canvas);

        const domNodes = PROJECTS_DATA.map((p, i) => {
          const el = document.createElement("div");
          el.className = "node";
          el.innerHTML = `<span class="node-icon">${p.icon}</span><div class="node-label">${p.name}</div>`;
          container.appendChild(el);
          gsap.from(el, {
            scale: 0,
            duration: 0.5,
            delay: i * 0.1,
            ease: "back.out(1.7)",
          });

          // Basic Drag Logic
          let isDragging = false;
          el.addEventListener("mousedown", () => {
            isDragging = true;
          });
          window.addEventListener("mouseup", () => {
            isDragging = false;
          });
          window.addEventListener("mousemove", (e) => {
            if (isDragging) {
              const rect = container.getBoundingClientRect();
              nodes[i].x = e.clientX - rect.left;
              nodes[i].y = e.clientY - rect.top;
              nodes[i].vx = 0;
              nodes[i].vy = 0;
            }
          });

          return el;
        });

        function update() {
          const width = canvas.width;
          const height = canvas.height;
          ctx.clearRect(0, 0, width, height);
          ctx.beginPath();
          ctx.strokeStyle = getComputedStyle(
            document.documentElement
          ).getPropertyValue("--accent-glow");

          nodes.forEach((n, i) => {
            n.x += n.vx;
            n.y += n.vy;
            if (n.x <= 20 || n.x >= width - 20) n.vx *= -1;
            if (n.y <= 20 || n.y >= height - 20) n.vy *= -1;

            domNodes[i].style.transform = `translate(${n.x - 22}px, ${
              n.y - 22
            }px)`;

            for (let j = i + 1; j < nodes.length; j++) {
              const dx = n.x - nodes[j].x;
              const dy = n.y - nodes[j].y;
              const dist = Math.sqrt(dx * dx + dy * dy);
              if (dist < 150) {
                ctx.moveTo(n.x, n.y);
                ctx.lineTo(nodes[j].x, nodes[j].y);
              }
            }
          });
          ctx.stroke();
          nodeSimulation = requestAnimationFrame(update);
        }
        update();
      }

      /* --------------------------------------------------------------------------
       * üß≠ PAGE LOGIC
       * -------------------------------------------------------------------------- */
      const menuItems = document.querySelectorAll(".menu-item");
      const contentContainer = document.getElementById("content");
      const scroller = document.getElementById("main-scroller");
      const overlay = document.getElementById("overlay");
      const bg3D = new SceneManager();

      function loadPage(pageKey) {
        const theme = THEMES[pageKey];

        // Animate CSS Vars
        gsap.to(document.documentElement, {
          "--bg": theme.bg,
          "--fg": theme.fg,
          "--accent": theme.accent,
          "--accent-glow": theme.accent + "66",
          duration: 1,
        });

        // Trigger 3D Color Change
        bg3D.changeColor(theme.threeColor);

        // Page Transition
        overlay.style.backgroundColor = theme.overlay;
        const tl = gsap.timeline();
        tl.to(overlay, {
          opacity: 1,
          duration: 0.4,
          ease: "power2.inOut",
          onComplete: () => {
            contentContainer.innerHTML = PAGES[pageKey];
            scroller.scrollTop = 0;

            if (nodeSimulation) cancelAnimationFrame(nodeSimulation);
            if (pageKey === "projects") initProjectsWeb();

            const title = contentContainer.querySelector(
              'h1[data-scramble="true"]'
            );
            if (title) scrambleText(title);
          },
        });

        tl.to(overlay, { opacity: 0, duration: 0.6, ease: "power2.inOut" });
        tl.fromTo(
          contentContainer.children,
          { y: 30, opacity: 0 },
          { y: 0, opacity: 1, stagger: 0.1, duration: 0.5 },
          "-=0.4"
        );
      }

      menuItems.forEach((item) => {
        item.addEventListener("click", () => {
          if (item.classList.contains("active")) return;
          menuItems.forEach((i) => i.classList.remove("active"));
          item.classList.add("active");
          loadPage(item.dataset.page);
        });
      });

      loadPage("home");
    </script>
  </body>
</html>
